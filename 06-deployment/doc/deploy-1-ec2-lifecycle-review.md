# [DEPLOY-1 ë³µìŠµ] EC2 ìˆ˜ë™ ë°°í¬ & systemd ìë™ ì‹¤í–‰

> ë¡œì»¬ ë¹Œë“œëœ Spring Boot JARë¥¼ AWS EC2(Ubuntu)ì— ë°°í¬í•˜ê³ ,
> 
> 
> **nohup / systemd** ë‘ ê°€ì§€ ë°©ì‹ì„ ëª¨ë‘ ë³µìŠµí•˜ë©°
> 
> ì„œë¹„ìŠ¤ ì‹¤í–‰Â·ì¢…ë£ŒÂ·ìë™í™” ê³¼ì •ì„ ì™„ì „íˆ ì²´ë“í•œë‹¤.
> 

---

## ğŸ’¡ í•µì‹¬ ê°œë… ìš”ì•½

| êµ¬ë¶„ | ê°œë… | ì„¤ëª… |
| --- | --- | --- |
| **nohup** | ë°±ê·¸ë¼ìš´ë“œ ìˆ˜ë™ ì‹¤í–‰ | í„°ë¯¸ë„ ì¢…ë£Œ í›„ì—ë„ ìœ ì§€ë˜ì§€ë§Œ, ì¬ë¶€íŒ… ì‹œ ì‚¬ë¼ì§ |
| **systemd** | ë¦¬ëˆ…ìŠ¤ ì„œë¹„ìŠ¤ ìë™ ì‹¤í–‰ | EC2 ë¶€íŒ… ì‹œ ìë™ ì‹¤í–‰, ë¡œê·¸/ìƒíƒœ ì¼ê´„ ê´€ë¦¬ |
| **í¬íŠ¸ ì ìœ ** | í”„ë¡œì„¸ìŠ¤ê°€ ì´ë¯¸ 8080 ì‚¬ìš© ì¤‘ì¼ ë•Œ ì¶©ëŒ | `sudo lsof -i :8080` ìœ¼ë¡œ í™•ì¸ |
| **ê¶Œí•œ ì¶©ëŒ** | root(systemd)ì™€ spring(nohup) ê°„ íŒŒì¼ ì†Œìœ ê¶Œ ë¶ˆì¼ì¹˜ | `sudo chown -R spring:spring /opt/app/springlab23` ë¡œ í•´ê²° |

---

## ğŸ§¾ ë³µìŠµ ì ˆì°¨ ìš”ì•½

### 1ï¸âƒ£ **nohup ë°©ì‹ (ìˆ˜ë™ ì‹¤í–‰ ë³µìŠµ)**

> í”„ë¡œì„¸ìŠ¤ ì œì–´ì™€ ë¡œê·¸ íë¦„ì„ ì§ì ‘ ê²½í—˜í•˜ê¸° ìœ„í•œ 1íšŒì„± ë³µìŠµ.
> 

```bash
# EC2 ì ‘ì†
ssh -i "C:\Users\ìƒˆë´„\Downloads\springlab-key.pem" ubuntu@<EC2_IP>

# spring ì‚¬ìš©ìë¡œ nohup ì‹¤í–‰
sudo -u spring bash -c "cd /opt/app/springlab23 && nohup java -jar springlab23-1.0.0.jar --spring.profiles.active=prod > app.log 2>&1 &"

# ì‹¤í–‰ í™•ì¸
ps -ef | grep java

# ë¡œê·¸ í™•ì¸
tail -f /opt/app/springlab23/app.log

# í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
sudo pkill -f 'springlab23'

```

ğŸ“Œ **í™•ì¸ í¬ì¸íŠ¸**

- `ps` ë¡œ java í”„ë¡œì„¸ìŠ¤ í™•ì¸
- `app.log` ìƒì„± ì—¬ë¶€
- `curl http://127.0.0.1:8080/hello` ì‘ë‹µ
- `pkill` í›„ `lsof -i :8080` ë¹„ì›Œì§€ëŠ”ì§€ í™•ì¸

---

### 2ï¸âƒ£ **systemd ë°©ì‹ (ìë™ ì‹¤í–‰ ë³µìŠµ)**

> ì‹¤ë¬´ í‘œì¤€ ë°©ì‹. ì„œë¹„ìŠ¤ ë“±ë¡ë¶€í„° ìë™ ì¬ì‹œì‘ê¹Œì§€ ì™„ì „íˆ ìµíˆê¸°.
> 

```bash
# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status springlab23 --no-pager

# ì¤‘ì§€
sudo systemctl stop springlab23

# ë‹¤ì‹œ ì‹¤í–‰
sudo systemctl start springlab23

# ì¬ë¶€íŒ… í›„ ìë™ ì‹¤í–‰ í™•ì¸
sudo reboot

```

> ì¬ë¶€íŒ… í›„ ë‹¤ì‹œ SSH ì ‘ì†:
> 

```bash
sudo systemctl status springlab23 --no-pager

```

âœ… `active (running)` í™•ì¸ ì‹œ ì™„ì „ ì„±ê³µ

---

## ğŸ“Œ ë³µìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

| í•­ëª© | ëª©í‘œ | í™•ì¸ ë°©ë²• | ìƒíƒœ |
| --- | --- | --- | --- |
| EC2 ì ‘ì† | ì„œë²„ ì ‘ì† ê°€ëŠ¥ | `ssh` ì •ìƒ ì—°ê²° | â˜ |
| JAR ì‹¤í–‰ (nohup) | ë¡œê·¸ íŒŒì¼ ìƒì„± ë° ì‘ë‹µ í™•ì¸ | `tail -f app.log` | â˜ |
| í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ | í¬íŠ¸ 8080 í•´ì œ | `sudo lsof -i :8080` | â˜ |
| systemd ì‹œì‘/ì¤‘ì§€ | ì„œë¹„ìŠ¤ ì œì–´ ìˆ™ë‹¬ | `sudo systemctl start/stop` | â˜ |
| ìë™ ì‹¤í–‰ í…ŒìŠ¤íŠ¸ | ì¬ë¶€íŒ… í›„ ì‹¤í–‰ ìœ ì§€ | `status â†’ active (running)` | â˜ |

---

## ğŸ§ª ì‹¤ìŠµ ë¯¸ì…˜

ğŸ¯ **ëª©í‘œ:**

nohupê³¼ systemd ë‘ ë°©ì‹ì„ ì§ì ‘ ë¹„êµí•˜ì—¬,

ì„œë¹„ìŠ¤ ì‹¤í–‰Â·ë¡œê·¸ ê´€ë¦¬Â·ìë™í™” ì°¨ì´ë¥¼ ì™„ì „íˆ ì´í•´í•œë‹¤.

1. `/opt/app/springlab23` ë””ë ‰í„°ë¦¬ ì •ë¦¬ (`sudo rm -f app.log`)
2. `nohup` ì‹¤í–‰ â†’ ë¡œê·¸ íŒŒì¼ ìƒì„± í™•ì¸
3. í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ (`sudo pkill -f 'springlab23'`)
4. `systemd` ì„œë¹„ìŠ¤ ì¬ì‹œì‘ (`sudo systemctl start springlab23`)
5. ë¸Œë¼ìš°ì €ì—ì„œ `http://<EC2_IP>:8080/hello` í™•ì¸
6. EC2 ì¬ë¶€íŒ… í›„ ìë™ ì‹¤í–‰ ì •ìƒ ë™ì‘ ì—¬ë¶€ ì ê²€

---

ğŸŒ¿ **ì •ë¦¬**

> nohupì€ ìˆ˜ë™ ì œì–´, systemdëŠ” ìë™í™” ì œì–´
> 
> 
> ë‘˜ ë‹¤ ê²½í—˜í•˜ë˜, ì‹¤ë¬´ ê¸°ì¤€ì€ **systemd**
> 
> ì´ë²ˆ ë³µìŠµìœ¼ë¡œ EC2 ì„œë¹„ìŠ¤ ì œì–´ ë£¨í‹´ì„ ì™„ì „íˆ ì²´ë“í•œë‹¤ ğŸ’ª
>